<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Roleta de Sorteios</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; flex-direction: column; align-items: center; background: #f0f2f5; margin: 0; padding: 20px; }
        .container { display: flex; gap: 40px; max-width: 900px; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); margin-top: 20px; flex-wrap: wrap; justify-content: center; }
        .canvas-container { position: relative; width: 500px; height: 500px; }
        #canvas { background: white; border-radius: 50%; border: 8px solid #333; }
        .seta { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-top: 30px solid #e74c3c; z-index: 10; }
        .controles { display: flex; flex-direction: column; gap: 15px; width: 300px; min-width: 250px; }
        textarea { height: 250px; padding: 15px; border-radius: 10px; border: 2px solid #ddd; font-size: 16px; line-height: 1.5; }
        button { padding: 18px; background: #27ae60; color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 20px; font-weight: bold; transition: transform 0.1s, background 0.3s; box-shadow: 0 4px 0 #1e8449; }
        button:active { transform: translateY(4px); box-shadow: none; }
        button:hover { background: #2ecc71; }
        #resultado { text-align: center; color: #2c3e50; min-height: 40px; font-size: 24px; font-weight: bold; margin-top: 10px; }
        .instrucao { font-size: 13px; color: #888; text-align: center; }
    </style>
</head>
<body>

    <h1 style="color: #1a1a1a;">Roleta de Sorteios</h1>

    <div class="container">
        <div class="canvas-container">
            <div class="seta"></div>
            <canvas id="canvas" width="500" height="500"></canvas>
        </div>

        <div class="controles">
            <label><strong>Op√ß√µes (uma por linha):</strong></label>
            <textarea id="opcoes">Pizza
Vale Ifood
Pix
Folga
Energ√©tico
2x Comiss√£o</textarea>
            
            <button id="btnSortear">SORTEAR (Enter)</button>
            <p class="instrucao">Pressione <b>Enter</b> para girar</p>
            <div id="resultado"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const btnSortear = document.getElementById('btnSortear');
        const txtOpcoes = document.getElementById('opcoes');
        const resText = document.getElementById('resultado');

        let anguloAtual = 0;
        let girando = false;

        function desenhar() {
            const itens = txtOpcoes.value.split('\n').filter(t => t.trim() !== "");
            const qtd = itens.length;
            if (qtd === 0) return;

            const slice = (2 * Math.PI) / qtd;
            ctx.clearRect(0, 0, 500, 500);

            itens.forEach((texto, i) => {
                const ang = i * slice;
                ctx.fillStyle = `hsl(${(i * 360 / qtd)}, 70%, 55%)`;
                
                // Desenha a fatia
                ctx.beginPath();
                ctx.moveTo(250, 250);
                ctx.arc(250, 250, 240, ang, ang + slice);
                ctx.lineTo(250, 250);
                ctx.fill();
                ctx.strokeStyle = "white";
                ctx.lineWidth = 2;
                ctx.stroke();

                // Desenha o texto
                ctx.save();
                ctx.translate(250, 250);
                ctx.rotate(ang + slice / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "white";
                ctx.font = "bold 16px Arial";
                ctx.fillText(texto.substring(0, 15), 230, 10);
                ctx.restore();
            });
        }

        function girar() {
            if (girando) return;
            const itens = txtOpcoes.value.split('\n').filter(t => t.trim() !== "");
            if (itens.length < 2) return alert("Adicione pelo menos 2 op√ß√µes!");

            girando = true;
            resText.innerText = "Sorteando...";
            
            const voltas = 10 + Math.random() * 10;
            const anguloFinal = anguloAtual + voltas * 2 * Math.PI + Math.random() * 2 * Math.PI;
            const duracao = 4000;
            const inicio = performance.now();

            function animar(agora) {
                const progresso = (agora - inicio) / duracao;
                if (progresso < 1) {
                    const easing = 1 - Math.pow(1 - progresso, 3);
                    const atual = anguloAtual + (anguloFinal - anguloAtual) * easing;
                    canvas.style.transform = `rotate(${atual}rad)`;
                    requestAnimationFrame(animar);
                } else {
                    girando = false;
                    anguloAtual = anguloFinal % (2 * Math.PI);
                    
                    const slice = (2 * Math.PI) / itens.length;
                    const realAng = (1.5 * Math.PI - anguloAtual) % (2 * Math.PI);
                    const indice = Math.floor((realAng < 0 ? realAng + 2 * Math.PI : realAng) / slice);
                    
                    resText.innerText = "üéâ " + itens[indice];
                }
            }
            requestAnimationFrame(animar);
        }

        txtOpcoes.addEventListener('input', desenhar);
        btnSortear.addEventListener('click', girar);
        
        window.addEventListener('keydown', (e) => {
            if (e.key === "Enter" && !girando) {
                if(document.activeElement !== txtOpcoes) girar();
            }
        });

        // For√ßa o desenho inicial
        window.onload = desenhar;
        desenhar();
    </script>
</body>
</html>
