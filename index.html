<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roleta de Sorteios Pro</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; display: flex; flex-direction: column; align-items: center; background: #f4f7f6; margin: 0; padding: 20px; }
        .container { display: flex; gap: 30px; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); flex-wrap: wrap; justify-content: center; }
        .canvas-container { position: relative; width: 500px; height: 500px; }
        #canvas { border-radius: 50%; border: 10px solid #333; background: #fff; transition: transform 4s cubic-bezier(0.1, 0, 0.2, 1); }
        .seta { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-top: 35px solid #ff4757; z-index: 10; filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2)); }
        .controles { width: 320px; display: flex; flex-direction: column; gap: 15px; }
        textarea { height: 250px; padding: 15px; border-radius: 10px; border: 2px solid #ddd; font-size: 16px; resize: none; outline: none; }
        textarea:focus { border-color: #27ae60; }
        button { padding: 20px; background: #27ae60; color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 22px; font-weight: bold; box-shadow: 0 5px 0 #1e8449; }
        button:active { transform: translateY(3px); box-shadow: 0 2px 0 #1e8449; }
        #resultado { font-size: 28px; font-weight: bold; color: #2f3542; text-align: center; margin-top: 15px; min-height: 40px; }
        .hint { font-size: 14px; color: #7f8c8d; text-align: center; }
    </style>
</head>
<body>

    <h1 style="margin-bottom: 30px; color: #2f3542;">ðŸŽ¡ Roleta de PrÃªmios</h1>

    <div class="container">
        <div class="canvas-container">
            <div class="seta"></div>
            <canvas id="canvas" width="500" height="500"></canvas>
        </div>

        <div class="controles">
            <label><b>OpÃ§Ãµes (uma por linha):</b></label>
            <textarea id="opcoes">Pizza
Vale Brinde
Pix R$ 50
Agradecemos
Tente Novamente
Combo Especial</textarea>
            
            <button id="btnSortear">SORTEAR (Enter)</button>
            <p class="hint">Dica: Clique fora da caixa de texto e aperte <b>Enter</b>!</p>
            <div id="resultado"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const btnSortear = document.getElementById('btnSortear');
        const txtOpcoes = document.getElementById('opcoes');
        const resText = document.getElementById('resultado');

        let opcoes = [];
        let girando = false;

        function desenharRoleta() {
            opcoes = txtOpcoes.value.split('\n').filter(t => t.trim() !== "");
            const qtd = opcoes.length;
            if (qtd === 0) return;

            const anguloFatia = (2 * Math.PI) / qtd;
            ctx.clearRect(0, 0, 500, 500);

            opcoes.forEach((texto, i) => {
                const anguloInicio = i * anguloFatia;
                
                // Cores vibrantes
                ctx.fillStyle = `hsl(${(i * 360 / qtd)}, 75%, 55%)`;
                ctx.beginPath();
                ctx.moveTo(250, 250);
                ctx.arc(250, 250, 240, anguloInicio, anguloInicio + anguloFatia);
                ctx.lineTo(250, 250);
                ctx.fill();
                ctx.strokeStyle = "#fff";
                ctx.lineWidth = 3;
                ctx.stroke();

                // Texto nas fatias
                ctx.save();
                ctx.translate(250, 250);
                ctx.rotate(anguloInicio + anguloFatia / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "#fff";
                ctx.font = "bold 18px sans-serif";
                ctx.fillText(texto.slice(0, 15), 230, 8);
                ctx.restore();
            });
        }

        function iniciarSorteio() {
            if (girando || opcoes.length < 2) return;
            girando = true;
            resText.innerText = "Sorteando...";

            const voltasExtras = Math.floor(Math.random() * 10) + 10; // 10 a 20 voltas
            const sorteioGraus = Math.floor(Math.random() * 360);
            const totalRotacao = (voltasExtras * 360) + sorteioGraus;
            
            canvas.style.transform = `rotate(${totalRotacao}deg)`;

            setTimeout(() => {
                girando = false;
                // CÃ¡lculo para saber qual fatia parou no topo
                const fatiaGraus = 360 / opcoes.length;
                const indiceVencedor = Math.floor(((360 - (sorteioGraus - 90)) % 360) / fatiaGraus);
                const vencedor = opcoes[indiceVencedor < 0 ? indiceVencedor + opcoes.length : indiceVencedor];
                resText.innerText = "ðŸ† " + vencedor;
            }, 4000); // Tempo da animaÃ§Ã£o no CSS
        }

        // Eventos
        txtOpcoes.addEventListener('input', desenharRoleta);
        btnSortear.addEventListener('click', iniciarSorteio);

        window.addEventListener('keydown', (e) => {
            if (e.key === "Enter" && !girando) {
                if (document.activeElement !== txtOpcoes) {
                    iniciarSorteio();
                }
            }
        });

        // Desenha a roleta assim que carrega
        desenharRoleta();
    </script>
</body>
</html>
