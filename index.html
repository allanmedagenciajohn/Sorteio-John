<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roleta de Sorteios Pro</title>
    <style>
        /* FUNDO PRETO E ESTILO DARK */
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            background: #121212; /* Fundo Preto */
            color: white;
            margin: 0; 
            padding: 20px; 
        }
        .container { 
            display: flex; 
            gap: 30px; 
            background: #1e1e1e; /* Fundo do painel lateral */
            padding: 30px; 
            border-radius: 20px; 
            box-shadow: 0 10px 50px rgba(0,0,0,0.5); 
            flex-wrap: wrap; 
            justify-content: center; 
        }
        .canvas-container { 
            position: relative; 
            width: 500px; 
            height: 500px; 
        }
        #canvas { 
            border-radius: 50%; 
            border: 10px solid #333; 
            background: #fff; 
            transition: transform 5s cubic-bezier(0.1, 0, 0.1, 1); /* Giro mais suave */
        }
        /* LOGO NO CENTRO */
        .centro-logo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px; /* Tamanho da sua logo */
            height: 80px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .centro-logo img {
            max-width: 100%;
            height: auto;
        }
        .seta { 
            position: absolute; 
            top: -20px; 
            left: 50%; 
            transform: translateX(-50%); 
            width: 0; 
            height: 0; 
            border-left: 20px solid transparent; 
            border-right: 20px solid transparent; 
            border-top: 40px solid #ff4757; 
            z-index: 10; 
            filter: drop-shadow(0 2px 5px rgba(0,0,0,0.5)); 
        }
        .controles { width: 320px; display: flex; flex-direction: column; gap: 15px; }
        textarea { 
            height: 250px; 
            padding: 15px; 
            border-radius: 10px; 
            border: 2px solid #333; 
            background: #2d2d2d;
            color: white;
            font-size: 16px; 
            outline: none; 
        }
        button { 
            padding: 20px; 
            background: #27ae60; 
            color: white; 
            border: none; 
            border-radius: 12px; 
            cursor: pointer; 
            font-size: 22px; 
            font-weight: bold; 
            box-shadow: 0 5px 0 #1e8449; 
        }
        button:active { transform: translateY(3px); box-shadow: 0 2px 0 #1e8449; }
        #resultado { 
            font-size: 32px; 
            font-weight: bold; 
            color: #2ecc71; 
            text-align: center; 
            margin-top: 15px; 
            min-height: 45px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>

    <h1 style="margin-bottom: 30px;">Roleta de Pr√™mios Agencia JOHN</h1>

    <div class="container">
        <div class="canvas-container">
            <div class="seta"></div>
            <div class="centro-logo">
                <img src="https://via.placeholder.com/80" id="logotipo john.png" alt="Logo">
            </div>
            <canvas id="canvas" width="500" height="500"></canvas>
        </div>

        <div class="controles">
            <label><b>Op√ß√µes (uma por linha):</b></label>
            <textarea id="opcoes">Op√ß√£o 1
Op√ß√£o 2
Op√ß√£o 3
Op√ß√£o 4
Op√ß√£o 5
Op√ß√£o 6</textarea>
            
            <button id="btnSortear">SORTEAR (Enter)</button>
            <div id="resultado"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const btnSortear = document.getElementById('btnSortear');
        const txtOpcoes = document.getElementById('opcoes');
        const resText = document.getElementById('resultado');

        let opcoes = [];
        let anguloAtual = 0;
        let girando = false;

        function desenharRoleta() {
            opcoes = txtOpcoes.value.split('\n').filter(t => t.trim() !== "");
            const qtd = opcoes.length;
            if (qtd === 0) return;

            const anguloFatia = (2 * Math.PI) / qtd;
            ctx.clearRect(0, 0, 500, 500);

            opcoes.forEach((texto, i) => {
                const anguloInicio = i * anguloFatia;
                
                ctx.fillStyle = `hsl(${(i * 360 / qtd)}, 70%, 50%)`;
                ctx.beginPath();
                ctx.moveTo(250, 250);
                ctx.arc(250, 250, 245, anguloInicio, anguloInicio + anguloFatia);
                ctx.lineTo(250, 250);
                ctx.fill();
                ctx.strokeStyle = "rgba(255,255,255,0.2)";
                ctx.lineWidth = 2;
                ctx.stroke();

                ctx.save();
                ctx.translate(250, 250);
                ctx.rotate(anguloInicio + anguloFatia / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "#fff";
                ctx.font = "bold 18px sans-serif";
                ctx.fillText(texto.slice(0, 15), 230, 8);
                ctx.restore();
            });
        }

        function iniciarSorteio() {
            if (girando || opcoes.length < 2) return;
            girando = true;
            resText.innerText = "Girando...";

            const tempoAnimacao = 8000; // 8 segundos
            const voltasExtras = 8 + Math.random() * 5; 
            const sorteioAleatorio = Math.random() * 360;
            const totalRotacaoDeg = (voltasExtras * 360) + sorteioAleatorio;
            
            // Aplica a rota√ß√£o
            canvas.style.transform = `rotate(${totalRotacaoDeg}deg)`;

            setTimeout(() => {
                girando = false;
                
                // C√ÅLCULO DE PRECIS√ÉO:
                // O √¢ngulo que para na seta (topo = 270¬∞)
                const anguloFinalEfetivo = (totalRotacaoDeg % 360);
                const fatiaGraus = 360 / opcoes.length;
                
                // Ajuste para encontrar o √≠ndice correto baseado no topo (270 deg)
                let indiceVencedor = Math.floor(((360 - (anguloFinalEfetivo - 90)) % 360) / fatiaGraus);
                
                if (indiceVencedor < 0) indiceVencedor += opcoes.length;
                
                const vencedor = opcoes[indiceVencedor];
                resText.innerText = "üèÜ " + vencedor;
                
                // Reiniciar √¢ngulo para n√£o dar saltos na pr√≥xima vez
                anguloAtual = totalRotacaoDeg % 360;
            }, tempoAnimacao);
        }

        txtOpcoes.addEventListener('input', desenharRoleta);
        btnSortear.addEventListener('click', iniciarSorteio);

        window.addEventListener('keydown', (e) => {
            if (e.key === "Enter" && !girando) {
                if (document.activeElement !== txtOpcoes) {
                    iniciarSorteio();
                }
            }
        });

        window.onload = desenharRoleta;
        desenharRoleta();
    </script>
</body>
</html>

